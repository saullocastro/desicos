
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Processing Geometric Imperfection Data &#8212; DESICOS 2.4.10 documentation</title>
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Adding New Imperfection Files" href="../add_file.html" />
    <link rel="prev" title="Dynamic Database" href="../dynamic.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="processing-geometric-imperfection-data">
<span id="process-raw-files"></span><h1>Processing Geometric Imperfection Data<a class="headerlink" href="#processing-geometric-imperfection-data" title="Permalink to this headline">¶</a></h1>
<p>This part of the turorial will explain in a step-by-step example how one
can use the <a class="reference internal" href="../../index.html#modules"><span class="std std-ref">developed modules</span></a> to post-process measured
imperfection data.</p>
<p>The following steps will be discussed:</p>
<ul class="simple">
<li><p>raw data from measurement system</p></li>
<li><p>finding</p></li>
</ul>
<div class="section" id="raw-data-from-mesurement-systems">
<h2>Raw Data from Mesurement Systems<a class="headerlink" href="#raw-data-from-mesurement-systems" title="Permalink to this headline">¶</a></h2>
<p>The raw files obtained from measured geometric imperfections usually come
with three columns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="n">y1</span> <span class="n">z1</span>
<span class="n">x2</span> <span class="n">y2</span> <span class="n">z2</span>
<span class="o">...</span>
<span class="n">xn</span> <span class="n">yn</span> <span class="n">zn</span>
</pre></div>
</div>
<p>The <a class="reference external" href="https://raw.githubusercontent.com/desicos/desicos/master/doc/source/tutorials/conecylDB/processing_measured_imp_data/sample.txt">following sample</a>
has been used to illustrate this tutorial (first 10 lines shown below):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">310.909</span>   <span class="mf">1174.136</span>   <span class="mf">261.8</span>
<span class="mf">146.126</span>   <span class="mf">754.321</span>   <span class="mf">378.119</span>
<span class="mf">216.694</span>   <span class="mf">1111.78</span>   <span class="mf">342.928</span>
<span class="o">-</span><span class="mf">261.395</span>   <span class="mf">1031.417</span>   <span class="o">-</span><span class="mf">314.052</span>
<span class="o">-</span><span class="mf">5.499</span>   <span class="mf">99.519</span>   <span class="o">-</span><span class="mf">407.764</span>
<span class="o">-</span><span class="mf">70.556</span>   <span class="mf">95.452</span>   <span class="o">-</span><span class="mf">401.672</span>
<span class="o">-</span><span class="mf">336.88</span>   <span class="mf">1148.365</span>   <span class="o">-</span><span class="mf">229.665</span>
<span class="o">-</span><span class="mf">351.651</span>   <span class="mf">705.414</span>   <span class="mf">204.226</span>
<span class="mf">403.703</span>   <span class="mf">454.238</span>   <span class="o">-</span><span class="mf">37.619</span>
<span class="mf">122.444</span>   <span class="mf">55.322</span>   <span class="mf">386.451</span>
</pre></div>
</div>
<p>The following script is used to plot the sample with the imperfection
exagerated. Note that <a class="reference internal" href="#best-fit-raw-data"><span class="std std-ref">best_fit_raw_data.py</span></a> has to
be executed before.</p>
<p><code class="docutils literal notranslate"><span class="pre">plot_sample_3d.py</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">mayavi.mlab</span> <span class="k">as</span> <span class="nn">mlab</span>

<span class="kn">from</span> <span class="nn">desicos.conecylDB.read_write</span> <span class="kn">import</span> <span class="n">xyz2thetazimp</span>

<span class="n">R</span> <span class="o">=</span> <span class="mf">406.4</span> <span class="c1"># nominal radius</span>
<span class="n">H</span> <span class="o">=</span> <span class="mf">1219.2</span> <span class="c1"># nominal height</span>
<span class="n">R_best_fit</span> <span class="o">=</span> <span class="mf">407.193</span> <span class="c1"># radius obtained with the best-fit routine</span>

<span class="n">thetas</span><span class="p">,</span> <span class="n">zfit</span><span class="p">,</span> <span class="n">dR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">&#39;sample_theta_z_imp.txt&#39;</span><span class="p">,</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">xpos</span> <span class="o">=</span> <span class="n">R_best_fit</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span>
<span class="n">ypos</span> <span class="o">=</span> <span class="n">R_best_fit</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span>
<span class="n">sf</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">xpos</span> <span class="o">+</span> <span class="n">sf</span><span class="o">*</span><span class="n">dR</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">ypos</span> <span class="o">+</span> <span class="n">sf</span><span class="o">*</span><span class="n">dR</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span>
<span class="n">z2</span> <span class="o">=</span> <span class="n">zfit</span>

<span class="n">Tinv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;tmp_Tinv.txt&#39;</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">Tinv</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x2</span><span class="p">))))</span>

<span class="n">black</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">white</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mlab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">bgcolor</span><span class="o">=</span><span class="n">white</span><span class="p">)</span>
<span class="n">mlab</span><span class="o">.</span><span class="n">points3d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">mlab</span><span class="o">.</span><span class="n">plot3d</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">600</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">black</span><span class="p">,</span> <span class="n">tube_radius</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">mlab</span><span class="o">.</span><span class="n">plot3d</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1600</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">black</span><span class="p">,</span> <span class="n">tube_radius</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">mlab</span><span class="o">.</span><span class="n">plot3d</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">600</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">black</span><span class="p">,</span> <span class="n">tube_radius</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">mlab</span><span class="o">.</span><span class="n">text3d</span><span class="p">(</span><span class="mi">650</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="o">+</span><span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">black</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">100.</span><span class="p">)</span>
<span class="n">mlab</span><span class="o">.</span><span class="n">text3d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1650</span><span class="p">,</span> <span class="o">+</span><span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">black</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">100.</span><span class="p">)</span>
<span class="n">mlab</span><span class="o">.</span><span class="n">text3d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">650</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">black</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">100.</span><span class="p">)</span>
<span class="n">mlab</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;plot_sample_3d.png&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">))</span>
</pre></div>
</div>
<p>giving:</p>
<div class="figure align-default">
<img alt="../../../_images/plot_sample_3d.png" src="../../../_images/plot_sample_3d.png" />
</div>
<p>In order to transform the raw data to the <a class="reference internal" href="../../../modules/abaqus/index.html#figure-conecyl"><span class="std std-ref">finite element coordinate
system</span></a>, the recommended procedure is the function
<a class="reference internal" href="../../../modules/conecylDB/index.html#desicos.conecylDB.read_write.xyz2thetazimp" title="desicos.conecylDB.read_write.xyz2thetazimp"><code class="xref py py-func docutils literal notranslate"><span class="pre">xyz2thetazimp()</span></code></a>, exemplified below. This function converts the “<img class="math" src="../../../_images/math/888f7c323ac0341871e867220ae2d76467d74d6e.png" alt="x"/> <img class="math" src="../../../_images/math/1b5e577d6216dca3af7d87aa122a0b9b360d6cb3.png" alt="y"/>
<img class="math" src="../../../_images/math/8d051150f8669295ecdbe92367941012175a824d.png" alt="z"/>” data to a to convert them to a “<img class="math" src="../../../_images/math/8a87f04e7d7cca18343c084cceca5237fae62491.png" alt="\theta"/> <img class="math" src="../../../_images/math/8d051150f8669295ecdbe92367941012175a824d.png" alt="z"/> <img class="math" src="../../../_images/math/de3645446a888e17a70c677bce72bcbdfa20a886.png" alt="imp"/>” format. This function
is a wrapper that calls funcion <a class="reference internal" href="../../../modules/conecylDB/index.html#desicos.conecylDB.fit_data.best_fit_cylinder" title="desicos.conecylDB.fit_data.best_fit_cylinder"><code class="xref py py-func docutils literal notranslate"><span class="pre">best_fit_cylinder()</span></code></a> or
<a class="reference internal" href="../../../modules/conecylDB/index.html#desicos.conecylDB.fit_data.best_fit_cone" title="desicos.conecylDB.fit_data.best_fit_cone"><code class="xref py py-func docutils literal notranslate"><span class="pre">best_fit_cone()</span></code></a>, where the right coordinate transformation is
calculated.</p>
<p id="best-fit-raw-data"><code class="docutils literal notranslate"><span class="pre">best_fit_raw_data.py</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">desicos.conecylDB.read_write</span> <span class="kn">import</span> <span class="n">xyz2thetazimp</span>

<span class="n">mps</span><span class="p">,</span> <span class="n">out</span> <span class="o">=</span> <span class="n">xyz2thetazimp</span><span class="p">(</span><span class="s1">&#39;sample.txt&#39;</span><span class="p">,</span> <span class="n">alphadeg_measured</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">R_expected</span><span class="o">=</span><span class="mf">406.4</span><span class="p">,</span>
        <span class="n">H_measured</span><span class="o">=</span><span class="mf">1219.2</span><span class="p">,</span> <span class="n">clip_bottom</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">clip_top</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">use_best_fit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">best_fit_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rotatedeg</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>

<span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;tmp_Tinv.txt&#39;</span><span class="p">,</span> <span class="n">out</span><span class="p">[</span><span class="s1">&#39;Tinv&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>It will create an output file with a prefix <code class="docutils literal notranslate"><span class="pre">&quot;_theta_z_imp.txt&quot;</span></code> where the
imperfection data is stored in the format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">theta1</span> <span class="n">z1</span> <span class="n">imp1</span>
<span class="n">theta2</span> <span class="n">z2</span> <span class="n">imp2</span>
<span class="o">...</span>
<span class="n">thetan</span> <span class="n">zn</span> <span class="n">impn</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">thetai</span></code> and <code class="docutils literal notranslate"><span class="pre">zi</span></code> are the coordinates <img class="math" src="../../../_images/math/8a87f04e7d7cca18343c084cceca5237fae62491.png" alt="\theta"/> and <img class="math" src="../../../_images/math/8d051150f8669295ecdbe92367941012175a824d.png" alt="z"/>, while
<code class="docutils literal notranslate"><span class="pre">impi</span></code> represents the imperfection amplitude at this coordinate. An example
of the transformed imperfection data is given below (first 10 lines), and
<a class="reference external" href="https://raw.githubusercontent.com/desicos/desicos/master/doc/source/tutorials/conecylDB/processing_measured_imp_data/sample_theta_z_imp.txt">the full output is given here</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.701704</span> <span class="mf">44.752223</span> <span class="o">-</span><span class="mf">0.299107</span>
<span class="mf">1.202029</span> <span class="mf">464.737892</span> <span class="o">-</span><span class="mf">0.772438</span>
<span class="mf">1.008550</span> <span class="mf">107.201740</span> <span class="o">-</span><span class="mf">0.834017</span>
<span class="o">-</span><span class="mf">2.266294</span> <span class="mf">188.347008</span> <span class="mf">0.697946</span>
<span class="o">-</span><span class="mf">1.581399</span> <span class="mf">1119.953672</span> <span class="o">-</span><span class="mf">0.574269</span>
<span class="o">-</span><span class="mf">1.742285</span> <span class="mf">1124.099646</span> <span class="o">-</span><span class="mf">0.728166</span>
<span class="o">-</span><span class="mf">2.545140</span> <span class="mf">71.468489</span> <span class="mf">0.131696</span>
<span class="mf">2.612788</span> <span class="mf">514.312597</span> <span class="o">-</span><span class="mf">0.417002</span>
<span class="o">-</span><span class="mf">0.090133</span> <span class="mf">764.620654</span> <span class="o">-</span><span class="mf">1.094824</span>
<span class="mf">1.261926</span> <span class="mf">1163.763315</span> <span class="o">-</span><span class="mf">0.307154</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is also possible to use <a class="reference internal" href="../../../modules/conecylDB/index.html#desicos.conecylDB.read_write.xyz2thetazimp" title="desicos.conecylDB.read_write.xyz2thetazimp"><code class="xref py py-func docutils literal notranslate"><span class="pre">xyz2thetazimp()</span></code></a> in other
ways, as detailed in the function’s documentation</p>
</div>
<p>The transformed data can also be visualized in the 3-D domain, which was
accomplished using the following script:</p>
<p><code class="docutils literal notranslate"><span class="pre">plot_sample_3d_tranformed.py</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">mayavi.mlab</span> <span class="k">as</span> <span class="nn">mlab</span>

<span class="kn">from</span> <span class="nn">desicos.conecylDB.read_write</span> <span class="kn">import</span> <span class="n">xyz2thetazimp</span>

<span class="n">R</span> <span class="o">=</span> <span class="mf">406.4</span>
<span class="n">R_best_fit</span> <span class="o">=</span> <span class="mf">407.168</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">&#39;sample_theta_z_imp.txt&#39;</span><span class="p">)</span>
<span class="n">thetas</span><span class="p">,</span> <span class="n">zfit</span><span class="p">,</span> <span class="n">dR</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">T</span>

<span class="n">xpos</span> <span class="o">=</span> <span class="n">R_best_fit</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span>
<span class="n">ypos</span> <span class="o">=</span> <span class="n">R_best_fit</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span>
<span class="n">sf</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">xpos</span> <span class="o">+</span> <span class="n">sf</span><span class="o">*</span><span class="n">dR</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">ypos</span> <span class="o">+</span> <span class="n">sf</span><span class="o">*</span><span class="n">dR</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span>
<span class="n">z2</span> <span class="o">=</span> <span class="n">zfit</span>

<span class="n">black</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">white</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mlab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">bgcolor</span><span class="o">=</span><span class="n">white</span><span class="p">)</span>
<span class="n">mlab</span><span class="o">.</span><span class="n">points3d</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">))</span>
<span class="n">mlab</span><span class="o">.</span><span class="n">plot3d</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">600</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">black</span><span class="p">,</span> <span class="n">tube_radius</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">mlab</span><span class="o">.</span><span class="n">plot3d</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">600</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">black</span><span class="p">,</span> <span class="n">tube_radius</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">mlab</span><span class="o">.</span><span class="n">plot3d</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1600</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">black</span><span class="p">,</span> <span class="n">tube_radius</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">mlab</span><span class="o">.</span><span class="n">text3d</span><span class="p">(</span><span class="mi">650</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="o">+</span><span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">black</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">100.</span><span class="p">)</span>
<span class="n">mlab</span><span class="o">.</span><span class="n">text3d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">650</span><span class="p">,</span> <span class="o">+</span><span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">black</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">100.</span><span class="p">)</span>
<span class="n">mlab</span><span class="o">.</span><span class="n">text3d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">1650</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">black</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">100.</span><span class="p">)</span>
<span class="n">mlab</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;plot_sample_3d_transformed.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>giving:</p>
<div class="figure align-default">
<img alt="../../../_images/plot_sample_3d_transformed.png" src="../../../_images/plot_sample_3d_transformed.png" />
</div>
<p>Note that due to the axisymmetry it may happen that the final result has some
offset rotation. For this reason the interpolation routines that will be
discussed in the next sessions of this tutorial include a <code class="docutils literal notranslate"><span class="pre">rotatedeg</span></code>
parameter that the analyst should use in order to correct this angular offset.</p>
</div>
<div class="section" id="inverse-weighted-interpolation">
<h2>Inverse-Weighted Interpolation<a class="headerlink" href="#inverse-weighted-interpolation" title="Permalink to this headline">¶</a></h2>
<p>Function <code class="xref py py-func docutils literal notranslate"><span class="pre">iterp_theta_z_imp()</span></code> is the one used to interpolate the
measured data into a given mesh. In the example below the mesh creates using
<code class="xref py py-func docutils literal notranslate"><span class="pre">np.meshgrid()</span></code> is used for plotting purposes. Note that the an angular
offset of <code class="docutils literal notranslate"><span class="pre">-88.5</span></code> degrees was used in order to adjust the imperfection.</p>
<p><code class="docutils literal notranslate"><span class="pre">interpolate_inv_weighted.py</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">desicos.conecylDB.interpolate</span> <span class="kn">import</span> <span class="n">interp_theta_z_imp</span>

<span class="n">R_model</span> <span class="o">=</span> <span class="mf">406.4</span> <span class="o">+</span> <span class="mf">0.8128</span><span class="o">/</span><span class="mf">2.</span>
<span class="n">H_measured</span> <span class="o">=</span> <span class="mf">1219.2</span>
<span class="n">ignore_bot_h</span> <span class="o">=</span> <span class="mf">25.4</span>
<span class="n">ignore_top_h</span> <span class="o">=</span> <span class="mf">25.4</span>

<span class="n">nz</span> <span class="o">=</span> <span class="mi">180</span>
<span class="n">nt</span> <span class="o">=</span> <span class="mi">560</span>

<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">nt</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">H_measured</span><span class="p">,</span> <span class="n">nz</span><span class="p">)</span>
<span class="n">T</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;sample_theta_z_imp.txt&#39;</span><span class="p">)</span>
<span class="n">ts</span><span class="p">,</span> <span class="n">zs</span><span class="p">,</span> <span class="n">imps</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">T</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">ts</span><span class="p">,</span> <span class="n">zs</span><span class="p">,</span> <span class="n">imps</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">T</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">Z</span><span class="o">.</span><span class="n">ravel</span><span class="p">()))</span><span class="o">.</span><span class="n">T</span>
<span class="n">w0</span> <span class="o">=</span> <span class="n">interp_theta_z_imp</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">semi_angle</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">H_measured</span><span class="o">=</span><span class="n">H_measured</span><span class="p">,</span> <span class="n">H_model</span><span class="o">=</span><span class="n">H_measured</span><span class="p">,</span> <span class="n">R_model</span><span class="o">=</span><span class="n">R_model</span><span class="p">,</span>
        <span class="n">stretch_H</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rotatedeg</span><span class="o">=-</span><span class="mf">88.5</span><span class="p">,</span> <span class="n">num_sub</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">ncp</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">power_parameter</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ignore_bot_h</span><span class="o">=</span><span class="n">ignore_bot_h</span><span class="p">,</span>
        <span class="n">ignore_top_h</span><span class="o">=</span><span class="n">ignore_top_h</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;tmp_inv_weighted.txt&#39;</span><span class="p">,</span>
           <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">T</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">Z</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">w0</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.8f</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>An the generated data can be plotted using the following code:</p>
<p><code class="docutils literal notranslate"><span class="pre">plot_inv_weighted.py</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">pi</span>
<span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">9.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">9.</span>

<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;tmp_inv_weighted.txt&#39;</span>

<span class="n">nz</span> <span class="o">=</span> <span class="mi">180</span>
<span class="n">nt</span> <span class="o">=</span> <span class="mi">560</span>

<span class="n">R</span> <span class="o">=</span> <span class="mf">407.168</span>

<span class="c1">#cmap = cm.jet</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">gist_rainbow_r</span>

<span class="n">theta</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>
<span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">w0</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">w0</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">400</span><span class="p">)</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">theta</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nz</span><span class="p">,</span> <span class="n">nt</span><span class="p">)</span><span class="o">*</span><span class="n">R</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nz</span><span class="p">,</span> <span class="n">nt</span><span class="p">),</span>
        <span class="n">w0</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nz</span><span class="p">,</span> <span class="n">nt</span><span class="p">),</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="o">-</span><span class="n">pi</span><span class="o">*</span><span class="n">R</span><span class="p">,</span> <span class="n">pi</span><span class="o">*</span><span class="n">R</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$-\pi$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\pi$&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\theta$ $[rad]$&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">labelpad</span><span class="o">=-</span><span class="mi">7</span>

<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1219.2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$x$</span><span class="se">\n</span><span class="s1">$[mm]$&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
        <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">labelpad</span><span class="o">=-</span><span class="mi">10</span>

<span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span>
<span class="k">if</span> <span class="n">colorbar</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">make_axes_locatable</span>

    <span class="n">fsize</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">cbar_nticks</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;5%&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">cbarticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">w0</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">w0</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">cbar_nticks</span><span class="p">)</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">cbarticks</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.3f</span><span class="s1">&#39;</span><span class="p">,</span>
                        <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
    <span class="n">cax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="s1">&#39;$w_0$ $[mm]$&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="n">fsize</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fsize</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">tick2On</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;plot_inv_weighted.png&#39;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">pad_inches</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>


</pre></div>
</div>
<p>giving:</p>
<div class="figure align-default">
<a class="reference internal image-reference" href="../../../_images/plot_inv_weighted.png"><img alt="../../../_images/plot_inv_weighted.png" src="../../../_images/plot_inv_weighted.png" style="width: 400px;" /></a>
</div>
</div>
<div class="section" id="half-cosine-function">
<h2>Half-Cosine Function<a class="headerlink" href="#half-cosine-function" title="Permalink to this headline">¶</a></h2>
<p>Function <a class="reference internal" href="../../../modules/conecylDB/index.html#desicos.conecylDB.fit_data.calc_c0" title="desicos.conecylDB.fit_data.calc_c0"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_c0()</span></code></a> is used to interpolate the measured data using
Fourier series. The half-cosine function corresponds to the parameter
<code class="docutils literal notranslate"><span class="pre">funcnum</span> <span class="pre">=</span> <span class="pre">2</span></code>, as can be seen in the function’s documentation.</p>
<p>The following script was used to calculate the coefficients <img class="math" src="../../../_images/math/52c2234a357e7a6a3d40b3c24090928a8d5c475e.png" alt="\{c_0\}"/>. Note
how the angular offset is applied using the <code class="docutils literal notranslate"><span class="pre">rotatedeg</span></code> parameter:</p>
<p><code class="docutils literal notranslate"><span class="pre">interpolate_half_cosine.py</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">desicos.conecylDB.fit_data</span> <span class="kn">import</span> <span class="n">calc_c0</span>

<span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;points&#39;</span>
<span class="n">funcnum</span><span class="o">=</span> <span class="mi">2</span>

<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;sample_theta_z_imp.txt&#39;</span>

<span class="n">R</span> <span class="o">=</span> <span class="mf">406.4</span> <span class="o">+</span> <span class="mf">0.8128</span><span class="o">/</span><span class="mf">2.</span>
<span class="n">H</span> <span class="o">=</span> <span class="mf">1219.2</span>
<span class="n">m0</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">n0</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">c0</span><span class="p">,</span> <span class="n">residues</span> <span class="o">=</span> <span class="n">calc_c0</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">m0</span><span class="o">=</span><span class="n">m0</span><span class="p">,</span> <span class="n">n0</span><span class="o">=</span><span class="n">n0</span><span class="p">,</span> <span class="n">funcnum</span><span class="o">=</span><span class="n">funcnum</span><span class="p">,</span> <span class="n">rotatedeg</span><span class="o">=-</span><span class="mf">88.5</span><span class="p">)</span>
<span class="n">outname</span> <span class="o">=</span> <span class="s1">&#39;tmp_c0_</span><span class="si">{0}</span><span class="s1">_f</span><span class="si">{1:d}</span><span class="s1">_m0_</span><span class="si">{2:03d}</span><span class="s1">_n0_</span><span class="si">{3:03d}</span><span class="s1">.txt&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">method</span><span class="p">,</span>
        <span class="n">funcnum</span><span class="p">,</span> <span class="n">m0</span><span class="p">,</span> <span class="n">n0</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">outname</span><span class="p">,</span> <span class="n">c0</span><span class="p">)</span>

</pre></div>
</div>
<p>and the following routine was used to plot the corresponding imperfection
field:</p>
<p><code class="docutils literal notranslate"><span class="pre">plot_half_cosine.py</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">pi</span>
<span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">compmech.conecyl.imperfections</span> <span class="kn">import</span> <span class="n">fw0</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">9.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">9.</span>

<span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;points&#39;</span>
<span class="n">funcnum</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;C01&#39;</span><span class="p">]</span>

<span class="n">nz</span> <span class="o">=</span> <span class="mi">180</span>
<span class="n">nt</span> <span class="o">=</span> <span class="mi">560</span>

<span class="n">H</span> <span class="o">=</span> <span class="mf">1219.2</span>
<span class="n">zpts_min</span> <span class="o">=</span> <span class="mf">25.4</span>
<span class="n">zpts_max</span> <span class="o">=</span> <span class="n">H</span> <span class="o">-</span> <span class="mf">25.4</span>
<span class="n">R</span> <span class="o">=</span> <span class="mf">406.4</span> <span class="o">+</span> <span class="mf">0.8128</span><span class="o">/</span><span class="mf">2.</span>

<span class="c1">#cmap = cm.jet</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">gist_rainbow_r</span>

<span class="n">m0</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">n0</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;tmp_c0_</span><span class="si">{0}</span><span class="s1">_f</span><span class="si">{1:d}</span><span class="s1">_m0_</span><span class="si">{2:03d}</span><span class="s1">_n0_</span><span class="si">{3:03d}</span><span class="s1">.txt&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">method</span><span class="p">,</span>
        <span class="n">funcnum</span><span class="p">,</span> <span class="n">m0</span><span class="p">,</span> <span class="n">n0</span><span class="p">)</span>
<span class="n">c0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">nt</span><span class="p">)</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">nz</span><span class="p">)</span>
<span class="n">zs</span> <span class="o">=</span> <span class="n">xs</span><span class="o">*</span><span class="n">H</span>
<span class="n">check</span> <span class="o">=</span> <span class="p">(</span><span class="n">zs</span> <span class="o">&gt;=</span> <span class="n">zpts_min</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">zs</span> <span class="o">&lt;=</span> <span class="n">zpts_max</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">xs</span><span class="p">[</span><span class="n">check</span><span class="p">]</span>
<span class="n">xs</span> <span class="o">-=</span> <span class="n">test</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">xs</span> <span class="o">/=</span> <span class="n">xs</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">xs</span><span class="p">[</span><span class="n">xs</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">xs</span><span class="p">[</span><span class="n">xs</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">dummy</span><span class="p">,</span> <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ts</span><span class="p">,</span> <span class="n">zs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">zs</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">w0</span> <span class="o">=</span> <span class="n">fw0</span><span class="p">(</span><span class="n">m0</span><span class="p">,</span> <span class="n">n0</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="n">funcnum</span><span class="o">=</span><span class="n">funcnum</span><span class="p">)</span>
<span class="n">w0</span><span class="o">.</span><span class="n">flat</span><span class="p">[(</span><span class="n">zs</span><span class="o">.</span><span class="n">flat</span> <span class="o">&lt;</span> <span class="n">zpts_min</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">zs</span><span class="o">.</span><span class="n">flat</span> <span class="o">&gt;</span> <span class="n">zpts_max</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>

<span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">w0</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">w0</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">400</span><span class="p">)</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">ts</span><span class="o">*</span><span class="n">R</span><span class="p">,</span> <span class="n">zs</span><span class="p">,</span> <span class="n">w0</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="o">-</span><span class="n">pi</span><span class="o">*</span><span class="n">R</span><span class="p">,</span> <span class="n">pi</span><span class="o">*</span><span class="n">R</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$-\pi$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\pi$&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\theta$ $[rad]$&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span>

<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">H</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$z$</span><span class="se">\n</span><span class="s1">$[mm]$&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
        <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>


<span class="n">colorbar</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">if</span> <span class="n">colorbar</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">make_axes_locatable</span>

    <span class="n">fsize</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">cbar_nticks</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;5%&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">cbarticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">w0</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">w0</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">cbar_nticks</span><span class="p">)</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">cbarticks</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.3f</span><span class="s1">&#39;</span><span class="p">,</span>
                        <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
    <span class="n">cax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="s1">&#39;$w_0$ $[mm]$&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="n">fsize</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fsize</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">tick2On</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;plot_half_cosine.png&#39;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span>
        <span class="n">pad_inches</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>



</pre></div>
</div>
<p>giving:</p>
<div class="figure align-default">
<a class="reference internal image-reference" href="../../../_images/plot_half_cosine.png"><img alt="../../../_images/plot_half_cosine.png" src="../../../_images/plot_half_cosine.png" style="width: 400px;" /></a>
</div>
<p>The relatively poor correlation between the half-cosine and the
inverse_weighted is primarily due to the reduced amount of measured data used
for this tutorial. Using real imperfection data the correlation is much
closer, as shown in the additional examples below.</p>
</div>
<div class="section" id="additional-examples-using-the-half-cosine-function">
<h2>Additional Examples using the Half-Cosine Function<a class="headerlink" href="#additional-examples-using-the-half-cosine-function" title="Permalink to this headline">¶</a></h2>
<p>The example below shows how to use this function and then plot the
displacement patterns using different approximation levels:</p>
<p><code class="docutils literal notranslate"><span class="pre">half_cosine_additional_example.py</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">from</span> <span class="nn">desicos.conecylDB.fit_data</span> <span class="kn">import</span> <span class="n">fw0</span>

<span class="n">ntheta</span> <span class="o">=</span> <span class="mi">420</span>
<span class="n">nz</span> <span class="o">=</span> <span class="mi">180</span>
<span class="n">funcnum</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;degenhardt_2010_z25_msi_theta_z_imp.txt&#39;</span>

<span class="n">theta</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">ntheta</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">nz</span><span class="p">)</span>
<span class="n">theta</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">meshgrid</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">for</span> <span class="n">m0</span><span class="p">,</span> <span class="n">n0</span> <span class="ow">in</span> <span class="p">[[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">],</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">]]:</span>
    <span class="n">c</span><span class="p">,</span> <span class="n">residues</span> <span class="o">=</span> <span class="n">calc_c0</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">m0</span><span class="o">=</span><span class="n">m0</span><span class="p">,</span> <span class="n">n0</span><span class="o">=</span><span class="n">n0</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="p">),</span>
                          <span class="n">funcnum</span><span class="o">=</span><span class="n">funcnum</span><span class="p">)</span>

    <span class="n">w0</span> <span class="o">=</span> <span class="n">fw0</span><span class="p">(</span><span class="n">m0</span><span class="p">,</span> <span class="n">n0</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">theta</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">funcnum</span><span class="o">=</span><span class="n">funcnum</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

    <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">w0</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">w0</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">400</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">z</span><span class="o">*</span><span class="n">H_measured</span><span class="p">,</span> <span class="n">w0</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">theta</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span>
                 <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">)</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span> <span class="n">pi</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$-\pi$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\pi$&#39;</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Circumferential Position, $rad$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">labelpad</span><span class="o">=-</span><span class="mi">10</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Height, $mm$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">labelpad</span><span class="o">=-</span><span class="mi">15</span>

    <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;fw0_f</span><span class="si">{0}</span><span class="s1">_z25_m_</span><span class="si">{1:03d}</span><span class="s1">_n_</span><span class="si">{2:03d}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">funcnum</span><span class="p">,</span> <span class="n">m0</span><span class="p">,</span> <span class="n">n0</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span>
                      <span class="n">pad_inches</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</pre></div>
</div>
<p>which will result in the following figures for <code class="docutils literal notranslate"><span class="pre">funcnum=1</span></code>:</p>
<p><img class="math" src="../../../_images/math/cde5fc363a01bf7c472b39636cf231e1aaa69fd3.png" alt="m_0=20"/>, <img class="math" src="../../../_images/math/79f380cb166dda439bcf3a0df1b6365ad43e4faf.png" alt="n_0=30"/>:</p>
<div class="figure align-default">
<img alt="../../../_images/fw0_f1_z25_m_020_n_030.png" src="../../../_images/fw0_f1_z25_m_020_n_030.png" />
</div>
<p><img class="math" src="../../../_images/math/897107b96ec00095dde78360e196b48dc5c0192f.png" alt="m_0=30"/>, <img class="math" src="../../../_images/math/f582b0ed6e1937c2648640ed96f453dafe7d15a4.png" alt="n_0=45"/>:</p>
<div class="figure align-default">
<img alt="../../../_images/fw0_f1_z25_m_030_n_045.png" src="../../../_images/fw0_f1_z25_m_030_n_045.png" />
</div>
<p><img class="math" src="../../../_images/math/ab14dfc5459a080ac5649ea4455e70c319204468.png" alt="m_0=40"/>, <img class="math" src="../../../_images/math/1a84bbf10fef78507b416b304dc7946cd6280919.png" alt="n_0=60"/>:</p>
<div class="figure align-default">
<img alt="../../../_images/fw0_f1_z25_m_040_n_060.png" src="../../../_images/fw0_f1_z25_m_040_n_060.png" />
</div>
<p><img class="math" src="../../../_images/math/36ddc9daaf8ca4535d84358b082fc3fcce2da182.png" alt="m_0=50"/>, <img class="math" src="../../../_images/math/6181a2fb45a72fbeb527164cbf580a1e4b32c7d3.png" alt="n_0=75"/>:</p>
<div class="figure align-default">
<img alt="../../../_images/fw0_f1_z25_m_050_n_075.png" src="../../../_images/fw0_f1_z25_m_050_n_075.png" />
</div>
<p>and for <code class="docutils literal notranslate"><span class="pre">funcnum=2</span></code>:</p>
<p><img class="math" src="../../../_images/math/cde5fc363a01bf7c472b39636cf231e1aaa69fd3.png" alt="m_0=20"/>, <img class="math" src="../../../_images/math/79f380cb166dda439bcf3a0df1b6365ad43e4faf.png" alt="n_0=30"/>:</p>
<div class="figure align-default">
<img alt="../../../_images/fw0_f2_z25_m_020_n_030.png" src="../../../_images/fw0_f2_z25_m_020_n_030.png" />
</div>
<p><img class="math" src="../../../_images/math/897107b96ec00095dde78360e196b48dc5c0192f.png" alt="m_0=30"/>, <img class="math" src="../../../_images/math/f582b0ed6e1937c2648640ed96f453dafe7d15a4.png" alt="n_0=45"/>:</p>
<div class="figure align-default">
<img alt="../../../_images/fw0_f2_z25_m_030_n_045.png" src="../../../_images/fw0_f2_z25_m_030_n_045.png" />
</div>
<p><img class="math" src="../../../_images/math/ab14dfc5459a080ac5649ea4455e70c319204468.png" alt="m_0=40"/>, <img class="math" src="../../../_images/math/1a84bbf10fef78507b416b304dc7946cd6280919.png" alt="n_0=60"/>:</p>
<div class="figure align-default">
<img alt="../../../_images/fw0_f2_z25_m_040_n_060.png" src="../../../_images/fw0_f2_z25_m_040_n_060.png" />
</div>
<p><img class="math" src="../../../_images/math/36ddc9daaf8ca4535d84358b082fc3fcce2da182.png" alt="m_0=50"/>, <img class="math" src="../../../_images/math/6181a2fb45a72fbeb527164cbf580a1e4b32c7d3.png" alt="n_0=75"/>:</p>
<div class="figure align-default">
<img alt="../../../_images/fw0_f2_z25_m_050_n_075.png" src="../../../_images/fw0_f2_z25_m_050_n_075.png" />
</div>
<p>It can be seen how the <img class="math" src="../../../_images/math/73036b31511ada0e09ed38a1a5ad0c9f8a2a5e86.png" alt="w_0"/> function approximates the measured imperfection
pattern with the increase of <img class="math" src="../../../_images/math/213e80d352bc46f440c8d0c7d55cc97ffd0c8ab6.png" alt="m_0"/> and <img class="math" src="../../../_images/math/213e80d352bc46f440c8d0c7d55cc97ffd0c8ab6.png" alt="m_0"/>. The measured imperfection
pattern is shown below, and it was plotted after performing the
inverse-weighted interpolation already described.</p>
<div class="figure align-default">
<img alt="../../../_images/measured_z25.png" src="../../../_images/measured_z25.png" />
</div>
<p>Comparing the results using <code class="docutils literal notranslate"><span class="pre">funcnum=1</span></code> and <code class="docutils literal notranslate"><span class="pre">funcnum=2</span></code>, one see that
the latter approaches closer the real measurements, since it relaxes the
condition <img class="math" src="../../../_images/math/1a77605dd4c9f78dfcd8ac523ef8392118bae7e9.png" alt="w_0 = 0"/> at the edges.</p>
</div>
</div>
<div class="section" id="processing-measured-thickness-imperfection-data">
<h1>Processing Measured Thickness Imperfection Data<a class="headerlink" href="#processing-measured-thickness-imperfection-data" title="Permalink to this headline">¶</a></h1>
<p>The procedure described for geometric imperfections is also applicable for
thickness imperfections. The measured imperfection data usually
comes in a 4 columns format where the thickness measurement is given for each
spatial position: <img class="math" src="../../../_images/math/c67734af70861b2bd4dedf5c41c9aad231466f84.png" alt="x_i"/>, <img class="math" src="../../../_images/math/09f199ae634ca653278cddfd301f2394bacb1777.png" alt="y_i"/>, <img class="math" src="../../../_images/math/c0d0f97cd9bb4e6571e2689163f9f2989b304f55.png" alt="z_i"/>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="n">y1</span> <span class="n">z1</span> <span class="n">thick1</span>
<span class="n">x2</span> <span class="n">y2</span> <span class="n">z2</span> <span class="n">thick2</span>
<span class="o">...</span>
<span class="n">xn</span> <span class="n">yn</span> <span class="n">zn</span> <span class="n">thickn</span>
</pre></div>
</div>
<p>The recommended procedure to transform the raw data to the <a class="reference internal" href="../../../modules/abaqus/index.html#figure-conecyl"><span class="std std-ref">finite
element coordinate system</span></a> is the function
<a class="reference internal" href="../../../modules/conecylDB/index.html#desicos.conecylDB.read_write.xyzthick2thetazthick" title="desicos.conecylDB.read_write.xyzthick2thetazthick"><code class="xref py py-func docutils literal notranslate"><span class="pre">xyzthick2thetazthick()</span></code></a>, that also calls internally the
<a class="reference internal" href="../../../modules/conecylDB/index.html#desicos.conecylDB.fit_data.best_fit_cylinder" title="desicos.conecylDB.fit_data.best_fit_cylinder"><code class="xref py py-func docutils literal notranslate"><span class="pre">best_fit_cylinder()</span></code></a> or the <a class="reference internal" href="../../../modules/conecylDB/index.html#desicos.conecylDB.fit_data.best_fit_cone" title="desicos.conecylDB.fit_data.best_fit_cone"><code class="xref py py-func docutils literal notranslate"><span class="pre">best_fit_cone()</span></code></a> routines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">desicos.conecylDB.read_write</span> <span class="kn">import</span> <span class="n">xyzthick2thetazthick</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">xyzthick2thetazthick</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">alphadeg_measured</span><span class="p">,</span> <span class="n">R_measured</span><span class="p">,</span> <span class="n">H_measured</span><span class="p">,</span>
<span class="go">                         fmt=&#39;%1.8f&#39;)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is possible to use function <code class="xref py py-func docutils literal notranslate"><span class="pre">xyzthick2thetazthick`()</span></code>
in other ways, as detailed in the corresponding documentation</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../../index.html">
    <img class="logo" src="../../../_static/desicos.png" alt="Logo"/>
    
  </a>
</p>










<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/index.html">Modules</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Tutorials</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2012-2020 Desicos Improved Software Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>