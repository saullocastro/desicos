
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>desicos.abaqus.imperfections.impconf &#8212; DESICOS 2.4.10 documentation</title>
    <link rel="stylesheet" href="../../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css" />
    <script id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for desicos.abaqus.imperfections.impconf</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">desicos.logger</span> <span class="kn">import</span> <span class="n">warn</span>
<span class="kn">from</span> <span class="nn">.uneven_edges</span> <span class="kn">import</span> <span class="n">Shim</span><span class="p">,</span> <span class="n">UnevenBottomEdge</span><span class="p">,</span> <span class="n">UnevenTopEdge</span>
<span class="kn">from</span> <span class="nn">.axisymmetric</span> <span class="kn">import</span> <span class="n">Axisymmetric</span>
<span class="kn">from</span> <span class="nn">.dimple</span> <span class="kn">import</span> <span class="n">Dimple</span>
<span class="kn">from</span> <span class="nn">.pload</span> <span class="kn">import</span> <span class="n">PLoad</span>
<span class="kn">from</span> <span class="nn">.cb</span> <span class="kn">import</span> <span class="n">CBamp</span>
<span class="kn">from</span> <span class="nn">.lbmi</span> <span class="kn">import</span> <span class="n">LBMI</span>
<span class="kn">from</span> <span class="nn">.msi</span> <span class="kn">import</span> <span class="n">MSI</span>
<span class="kn">from</span> <span class="nn">.ti</span> <span class="kn">import</span> <span class="n">TI</span>
<span class="kn">from</span> <span class="nn">.cutout</span> <span class="kn">import</span> <span class="n">Cutout</span>
<span class="kn">from</span> <span class="nn">.ppi</span> <span class="kn">import</span> <span class="n">PPI</span>
<span class="kn">from</span> <span class="nn">.ffi</span> <span class="kn">import</span> <span class="n">FFI</span>


<div class="viewcode-block" id="ImpConf"><a class="viewcode-back" href="../../../../modules/abaqus/index.html#desicos.abaqus.imperfections.impconf.ImpConf">[docs]</a><span class="k">class</span> <span class="nc">ImpConf</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Imperfection Configuration</span>

<span class="sd">    Created by default as one attribute of the :class:`.ConeCyl` object,</span>
<span class="sd">    accessed through::</span>

<span class="sd">        cc = ConeCyl()</span>
<span class="sd">        impconf = cc.impconf</span>

<span class="sd">    If one has the ``impconf`` object and wants to access the corresponding</span>
<span class="sd">    :class:`ConeCyl` object, the attribute ``conecyl`` can be used as</span>
<span class="sd">    examplified below.  Note that if no :class:`.ConeCyl` is assigned to this</span>
<span class="sd">    imperfection configuration a ``None`` value will be obtained::</span>

<span class="sd">        cc = impconf.conecyl</span>

<span class="sd">    The imperfections are grouped in the attributes detailed below.</span>

<span class="sd">    ================== ========================================================</span>
<span class="sd">    Attributes         Description</span>
<span class="sd">    ================== ========================================================</span>
<span class="sd">    uneven_bottom_edge :class:`.UnevenBottomEdge` object</span>
<span class="sd">    uneven_top_edge    :class:`.UnevenTopEdge` object</span>
<span class="sd">    ploads             ``list`` of :class:`.PLoad` (Perturbation Load) objects</span>
<span class="sd">    dimples            ``list`` of :class:`.Dimple` (Dimple Imperfection)</span>
<span class="sd">                       objects</span>
<span class="sd">    axisymmetrics      ``list`` of :class:`.Axisymmetric` (Axisymmetric</span>
<span class="sd">                       Imperfection) objects</span>
<span class="sd">    lbmis              ``list`` of :class:`.LBMI` (Linear Buckling Mode-Shaped</span>
<span class="sd">                       Imperfection) objects</span>
<span class="sd">    tis                ``list`` of :class:`.TI` (Thickness Imperfection)</span>
<span class="sd">                       objects</span>
<span class="sd">    msis               ``list`` of :class:`.MSI` (Mid-Surface Imperfection)</span>
<span class="sd">                       objects</span>
<span class="sd">    cutouts            ``list`` of :class:`.Cutout` objects</span>
<span class="sd">    ppi                :class:`.PPI` (Ply Piece Imperfection) object or</span>
<span class="sd">                       ``None`` if not set</span>
<span class="sd">    ffi                :class:`.FFI` (Fiber Fraction Imperfection) object or</span>
<span class="sd">                       ``None`` if not set</span>
<span class="sd">    ================== ========================================================</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uneven_bottom_edge</span> <span class="o">=</span> <span class="n">UnevenBottomEdge</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uneven_bottom_edge</span><span class="o">.</span><span class="n">impconf</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uneven_top_edge</span> <span class="o">=</span> <span class="n">UnevenTopEdge</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uneven_top_edge</span><span class="o">.</span><span class="n">impconf</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imperfections</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ploads</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cb</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dimples</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axisymmetrics</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbmis</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msis</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tis</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cutouts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ppi</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ffi</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rename</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conecyl</span> <span class="o">=</span> <span class="kc">None</span>


    <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
        <span class="c1"># Called during unpickling (i.e. loading)</span>
        <span class="c1"># Calling __init__ prevents problems with missing attributes,</span>
        <span class="c1"># when loading from older versions</span>
        <span class="bp">self</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">attrs</span><span class="p">)</span>


<div class="viewcode-block" id="ImpConf.add_axisymmetric"><a class="viewcode-back" href="../../../../modules/abaqus/index.html#desicos.abaqus.imperfections.impconf.ImpConf.add_axisymmetric">[docs]</a>    <span class="k">def</span> <span class="nf">add_axisymmetric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">wb</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an Axisymmetric Imperfection (AI)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pt : float</span>
<span class="sd">            Normalized meridional position.</span>
<span class="sd">        b : float</span>
<span class="sd">            Half-wave length.</span>
<span class="sd">        wb : float</span>
<span class="sd">            Imperfection amplitude (amplitude of the half-wave).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ax : :class:`.Axisymmetric` object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">Axisymmetric</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">wb</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">impconf</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axisymmetrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="ImpConf.add_dimple"><a class="viewcode-back" href="../../../../modules/abaqus/index.html#desicos.abaqus.imperfections.impconf.ImpConf.add_dimple">[docs]</a>    <span class="k">def</span> <span class="nf">add_dimple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thetadeg</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">wb</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a Dimple Imperfection (DI)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        thetadeg : float</span>
<span class="sd">            Circumferential position of the dimple.</span>
<span class="sd">        a : float</span>
<span class="sd">            Circumferential half-wave length of the dimple.</span>
<span class="sd">        b : float</span>
<span class="sd">            Meridional half-wave length of the dimple.</span>
<span class="sd">        wb : float</span>
<span class="sd">            Imperfection amplitude.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        d : :class:`.Dimple` object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">Dimple</span><span class="p">(</span><span class="n">thetadeg</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">wb</span><span class="p">)</span>
        <span class="n">d</span><span class="o">.</span><span class="n">impconf</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dimples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">d</span></div>


<div class="viewcode-block" id="ImpConf.add_lbmi"><a class="viewcode-back" href="../../../../modules/abaqus/index.html#desicos.abaqus.imperfections.impconf.ImpConf.add_lbmi">[docs]</a>    <span class="k">def</span> <span class="nf">add_lbmi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">scaling_factor</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a Linear Buckling Mode-shaped Imperfection (LBMI)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mode : int</span>
<span class="sd">            Mode number corresponding to this eigenvector.</span>
<span class="sd">        scaling_factor : float</span>
<span class="sd">            Amplitude of this eigenvector when applied as an imperfection.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        lbmi : :class:`.LBMI` object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lbmi</span> <span class="o">=</span> <span class="n">LBMI</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">scaling_factor</span><span class="p">)</span>
        <span class="n">lbmi</span><span class="o">.</span><span class="n">impconf</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lbmis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lbmi</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lbmi</span></div>


<div class="viewcode-block" id="ImpConf.add_measured_u3s_bottom_edge"><a class="viewcode-back" href="../../../../modules/abaqus/index.html#desicos.abaqus.imperfections.impconf.ImpConf.add_measured_u3s_bottom_edge">[docs]</a>    <span class="k">def</span> <span class="nf">add_measured_u3s_bottom_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thetadegs</span><span class="p">,</span> <span class="n">u3s</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Add a measured uneven bottom edge</span>

<span class="sd">        Straightforward method to include measured data about the bottom edge</span>
<span class="sd">        imperfection.</span>

<span class="sd">        Adopts the coordinate system of :ref:`this figure &lt;figure_conecyl&gt;`</span>
<span class="sd">        when defining the `u_3` displacements for each `\theta` value.</span>

<span class="sd">        The edge imperfection that actually goes for each node is a linear</span>
<span class="sd">        interpolation of the measured values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        thetadegs : list</span>
<span class="sd">            The circumferential positions where the imperfect bottom edge was</span>
<span class="sd">            measured, in degrees.</span>
<span class="sd">        u3s : list</span>
<span class="sd">            The measured imperfections representing displacements along the</span>
<span class="sd">            `X_3` axis :ref:`of the adopted model &lt;figure_conecyl&gt;`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uneven_bottom_edge</span><span class="o">.</span><span class="n">add_measured_u3s</span><span class="p">(</span><span class="n">thetadegs</span><span class="p">,</span> <span class="n">u3s</span><span class="p">)</span></div>


<div class="viewcode-block" id="ImpConf.add_measured_u3s_top_edge"><a class="viewcode-back" href="../../../../modules/abaqus/index.html#desicos.abaqus.imperfections.impconf.ImpConf.add_measured_u3s_top_edge">[docs]</a>    <span class="k">def</span> <span class="nf">add_measured_u3s_top_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thetadegs</span><span class="p">,</span> <span class="n">u3s</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Add a measured uneven top edge</span>

<span class="sd">        Straightforward method to include measured data about the top edge</span>
<span class="sd">        imperfection.</span>

<span class="sd">        Adopts the coordinate system of :ref:`this figure &lt;figure_conecyl&gt;`</span>
<span class="sd">        when defining the `u_3` displacements for each `\theta` value.</span>

<span class="sd">        The edge imperfection that actually goes for each node is a linear</span>
<span class="sd">        interpolation of the measured values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        thetadegs : list</span>
<span class="sd">            The circumferential positions where the imperfect top edge was</span>
<span class="sd">            measured, in degrees.</span>
<span class="sd">        u3s : list</span>
<span class="sd">            The measured imperfections representing displacements along the</span>
<span class="sd">            `X_3` axis :ref:`of the adopted model &lt;figure_conecyl&gt;`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uneven_top_edge</span><span class="o">.</span><span class="n">add_measured_u3s</span><span class="p">(</span><span class="n">thetadegs</span><span class="p">,</span> <span class="n">u3s</span><span class="p">)</span></div>


<div class="viewcode-block" id="ImpConf.add_msi"><a class="viewcode-back" href="../../../../modules/abaqus/index.html#desicos.abaqus.imperfections.impconf.ImpConf.add_msi">[docs]</a>    <span class="k">def</span> <span class="nf">add_msi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">imp_ms</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">scaling_factor</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">R_best_fit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">H_measured</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_theta_z_format</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">rotatedeg</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">ignore_bot_h</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ignore_top_h</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">stretch_H</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">c0</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">m0</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n0</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">funcnum</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Add a Mid-Surface Imperfection (MSI)</span>

<span class="sd">        Also called geometric imperfection.</span>

<span class="sd">        If the imperfection is :ref:`already included in the database</span>
<span class="sd">        &lt;tutorials_conecylDB&gt;` only the corresponding entry ``imp_ms`` and</span>
<span class="sd">        the scaling factor need to be specified.</span>

<span class="sd">        If the imperfection is not in the database one can specify the</span>
<span class="sd">        full path for the file containing the imperfection, the measured</span>
<span class="sd">        radius and height, as detailed below.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        imp_ms : str, optional</span>
<span class="sd">            Name of the imperfection in the database.</span>
<span class="sd">        scaling_factor : float, optional</span>
<span class="sd">            Scaling factor applied to the original imperfection amplitude,</span>
<span class="sd">            usually to allow imperfection sensitivity studies.</span>
<span class="sd">        R_best_fit : float, optional</span>
<span class="sd">            Best fit radius obtained with functions :func:`.best_fit_cylinder`</span>
<span class="sd">            or :func:`.best_fit_cone`.</span>
<span class="sd">        alphadeg_measured : float</span>
<span class="sd">            The semi-vertex angle of the measured sample (it is ``0.`` for a</span>
<span class="sd">            cylinder).</span>
<span class="sd">        H_measured : float, optional</span>
<span class="sd">            The total height of the measured test specimen, including eventual</span>
<span class="sd">            resin rings at the edges.</span>
<span class="sd">        path : str, optional</span>
<span class="sd">            Full path to the file containing the imperfection data.</span>
<span class="sd">        use_theta_z_format : bool, optional</span>
<span class="sd">            If the imperfection file is in the `\theta, Z, imp` format</span>
<span class="sd">            instead of the `X, Y, Z` format.</span>
<span class="sd">        rotatedeg : float, optional</span>
<span class="sd">            Rotation angle in degrees telling how much the imperfection</span>
<span class="sd">            pattern should be rotated about the `X_3` (or `Z`) axis.</span>
<span class="sd">        ignore_bot_h : float, optional</span>
<span class="sd">            Used to ignore nodes from the bottom resin ring. The default value</span>
<span class="sd">            ``True`` will use data from the bottom resin ring, if it exists.</span>
<span class="sd">        ignore_top_h : float, optional</span>
<span class="sd">            Used to ignore nodes from the top resin ring. The default value</span>
<span class="sd">            ``True`` will use data from the top resin ring, if it exists.</span>
<span class="sd">        stretch_H : bool, optional</span>
<span class="sd">            If the measured imperfection does not cover the whole height it</span>
<span class="sd">            will be stretched. If ``stretch_H==True``, ``ignore_bot_h`` and</span>
<span class="sd">            ``ignore_top_h`` are automatically set to ``False``.</span>
<span class="sd">        c0 : str or np.ndarray, optional</span>
<span class="sd">            The coefficients representing the imperfection pattern. If</span>
<span class="sd">            supplied will overwrite the imperfection data passed using the</span>
<span class="sd">            other parameters. For more details see :func:`.calc_c0`.</span>
<span class="sd">        m0 : int, optional</span>
<span class="sd">            Number of terms along the meridian (`z`) used to obtain ``c0``,</span>
<span class="sd">            see :func:`.calc_c0`.</span>
<span class="sd">        n0 : int, optional</span>
<span class="sd">            Number of terms along the circumference (`\theta`) used to obtain</span>
<span class="sd">            ``c0``, see :func:`.calc_c0`.</span>
<span class="sd">        funcnum : int, optional</span>
<span class="sd">            The base function used to obtain ``c0``, see :func:`.calc_c0`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        msi : :class:`.MSI` object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msi</span> <span class="o">=</span> <span class="n">MSI</span><span class="p">()</span>
        <span class="n">msi</span><span class="o">.</span><span class="n">impconf</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">msi</span><span class="o">.</span><span class="n">imp_ms</span> <span class="o">=</span> <span class="n">imp_ms</span>
        <span class="n">msi</span><span class="o">.</span><span class="n">scaling_factor</span> <span class="o">=</span> <span class="n">scaling_factor</span>
        <span class="n">msi</span><span class="o">.</span><span class="n">use_theta_z_format</span> <span class="o">=</span> <span class="n">use_theta_z_format</span>
        <span class="n">msi</span><span class="o">.</span><span class="n">R_best_fit</span> <span class="o">=</span> <span class="n">R_best_fit</span>
        <span class="n">msi</span><span class="o">.</span><span class="n">H_measured</span> <span class="o">=</span> <span class="n">H_measured</span>
        <span class="n">msi</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="n">msi</span><span class="o">.</span><span class="n">rotatedeg</span> <span class="o">=</span> <span class="n">rotatedeg</span>
        <span class="n">msi</span><span class="o">.</span><span class="n">ignore_bot_h</span> <span class="o">=</span> <span class="n">ignore_bot_h</span>
        <span class="n">msi</span><span class="o">.</span><span class="n">ignore_top_h</span> <span class="o">=</span> <span class="n">ignore_top_h</span>
        <span class="n">msi</span><span class="o">.</span><span class="n">stretch_H</span> <span class="o">=</span> <span class="n">stretch_H</span>

        <span class="k">if</span> <span class="n">c0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">m0</span> <span class="ow">and</span> <span class="n">n0</span> <span class="ow">and</span> <span class="n">funcnum</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Parameter &quot;c0&quot; must be supplied with &#39;</span> <span class="o">+</span>
                             <span class="s1">&#39;&quot;m0&quot;, &quot;n0&quot; and &quot;funcnum&quot;&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">c0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">m0</span> <span class="ow">and</span> <span class="n">n0</span> <span class="ow">and</span> <span class="n">funcnum</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">funcnum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">size</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="n">funcnum</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">size</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="n">funcnum</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">size</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid value for &quot;funcnum&quot;!&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c0</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">c0</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;File </span><span class="si">{0}</span><span class="s1"> not found!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c0</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">c0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">c0</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">c0</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">c0</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">size</span><span class="o">*</span><span class="n">m0</span><span class="o">*</span><span class="n">n0</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                                <span class="s1">&#39;Invalid &quot;c0&quot; for the given &quot;m0&quot; and &quot;n0&quot;!&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                                <span class="s1">&#39;Array for &quot;c0&quot; must be one-dimensional!&#39;</span><span class="p">)</span>
        <span class="n">msi</span><span class="o">.</span><span class="n">c0</span> <span class="o">=</span> <span class="n">c0</span>
        <span class="n">msi</span><span class="o">.</span><span class="n">m0</span> <span class="o">=</span> <span class="n">m0</span>
        <span class="n">msi</span><span class="o">.</span><span class="n">n0</span> <span class="o">=</span> <span class="n">n0</span>
        <span class="n">msi</span><span class="o">.</span><span class="n">funcnum</span> <span class="o">=</span> <span class="n">funcnum</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msi</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">msi</span></div>


<div class="viewcode-block" id="ImpConf.add_pload"><a class="viewcode-back" href="../../../../modules/abaqus/index.html#desicos.abaqus.imperfections.impconf.ImpConf.add_pload">[docs]</a>    <span class="k">def</span> <span class="nf">add_pload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thetadeg</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="n">pltotal</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a Perturbation Load</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        thetadeg : float</span>
<span class="sd">            Circumferential position.</span>
<span class="sd">        pt : float</span>
<span class="sd">            Normalized meridional position.</span>
<span class="sd">        pltotal : float</span>
<span class="sd">            The magnitude of the perturbation load (it is always applied</span>
<span class="sd">            normally to the shell surface).</span>
<span class="sd">        step : int</span>
<span class="sd">            The step in which the perturbation load will be included. In</span>
<span class="sd">            ``step=1`` the load is constant along the analysis while in</span>
<span class="sd">            ``step=2`` the load is incremented.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pload : :class:`.PLoad` object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pload</span> <span class="o">=</span> <span class="n">PLoad</span><span class="p">(</span><span class="n">thetadeg</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="n">pltotal</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
        <span class="n">pload</span><span class="o">.</span><span class="n">impconf</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ploads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pload</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pload</span></div>


<div class="viewcode-block" id="ImpConf.add_cb"><a class="viewcode-back" href="../../../../modules/abaqus/index.html#desicos.abaqus.imperfections.impconf.ImpConf.add_cb">[docs]</a>    <span class="k">def</span> <span class="nf">add_cb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thetadeg</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="n">cbtotal</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a Constant Amplitude Perturbation Buckle Imperfection</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        thetadeg : float</span>
<span class="sd">            Circumferential position.</span>
<span class="sd">        pt : float</span>
<span class="sd">            Normalized meridional position.</span>
<span class="sd">        cbtotal : float</span>
<span class="sd">            The magnitude of the constant buckle (it is always applied</span>
<span class="sd">            normally to the shell surface).</span>
<span class="sd">        step : int</span>
<span class="sd">            The step in which the constant buckle will be included. In</span>
<span class="sd">            ``step=1`` the load is constant along the analysis while in</span>
<span class="sd">            ``step=2`` the load is incremented.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        cb : :class:`.CBamp` object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="n">CBamp</span><span class="p">(</span><span class="n">thetadeg</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="n">cbtotal</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">impconf</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cb</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cb</span></div>


<div class="viewcode-block" id="ImpConf.add_shim_bottom_edge"><a class="viewcode-back" href="../../../../modules/abaqus/index.html#desicos.abaqus.imperfections.impconf.ImpConf.add_shim_bottom_edge">[docs]</a>    <span class="k">def</span> <span class="nf">add_shim_bottom_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thetadeg</span><span class="p">,</span> <span class="n">thick</span><span class="p">,</span> <span class="n">width</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a Shim to the bottom edge</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        thetadeg : float</span>
<span class="sd">            Circumferential position where the shim starts.</span>
<span class="sd">        thick : float</span>
<span class="sd">            Thickness of the shim.</span>
<span class="sd">        width : float</span>
<span class="sd">            Perimetrical width of the shim (along the shell perimeter).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        shim : :class:`.Shim` object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">shim</span> <span class="o">=</span> <span class="n">Shim</span><span class="p">(</span><span class="n">thetadeg</span><span class="p">,</span> <span class="n">thick</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">uneven_bottom_edge</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">shim</span></div>


<div class="viewcode-block" id="ImpConf.add_shim_top_edge"><a class="viewcode-back" href="../../../../modules/abaqus/index.html#desicos.abaqus.imperfections.impconf.ImpConf.add_shim_top_edge">[docs]</a>    <span class="k">def</span> <span class="nf">add_shim_top_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thetadeg</span><span class="p">,</span> <span class="n">thick</span><span class="p">,</span> <span class="n">width</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a Shim to the top edge</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        thetadeg : float</span>
<span class="sd">            Circumferential position where the shim starts.</span>
<span class="sd">        thick : float</span>
<span class="sd">            Thickness of the shim.</span>
<span class="sd">        width : float</span>
<span class="sd">            Perimetrical width of the shim (along the shell perimeter).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        shim : :class:`.Shim` object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">shim</span> <span class="o">=</span> <span class="n">Shim</span><span class="p">(</span><span class="n">thetadeg</span><span class="p">,</span> <span class="n">thick</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">uneven_top_edge</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">shim</span></div>


<div class="viewcode-block" id="ImpConf.add_ti"><a class="viewcode-back" href="../../../../modules/abaqus/index.html#desicos.abaqus.imperfections.impconf.ImpConf.add_ti">[docs]</a>    <span class="k">def</span> <span class="nf">add_ti</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">imp_thick</span><span class="p">,</span> <span class="n">scaling_factor</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add Thickness Imperfection (TI)</span>

<span class="sd">        The imperfection must be already included in the database (:ref:`check</span>
<span class="sd">        this tutorial &lt;tutorials_conecylDB&gt;`).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        imp_thick : str</span>
<span class="sd">            Name of the thickness imperfection in the database.</span>
<span class="sd">        scaling_factor : float</span>
<span class="sd">            Scaling factor applied to the original imperfection amplitude,</span>
<span class="sd">            usually to allow imperfection sensitivity studies.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ti : :class:`.TI` object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ti</span> <span class="o">=</span> <span class="n">TI</span><span class="p">()</span>
        <span class="n">ti</span><span class="o">.</span><span class="n">impconf</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">ti</span><span class="o">.</span><span class="n">imp_thick</span> <span class="o">=</span> <span class="n">imp_thick</span>
        <span class="n">ti</span><span class="o">.</span><span class="n">scaling_factor</span> <span class="o">=</span> <span class="n">scaling_factor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ti</span></div>


<div class="viewcode-block" id="ImpConf.add_cutout"><a class="viewcode-back" href="../../../../modules/abaqus/index.html#desicos.abaqus.imperfections.impconf.ImpConf.add_cutout">[docs]</a>    <span class="k">def</span> <span class="nf">add_cutout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thetadeg</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">drill_offset_deg</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span>
                   <span class="n">clearance_factor</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">numel_radial_edge</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                   <span class="n">prop_around_cutout</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Add a cutout</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        thetadeg : float</span>
<span class="sd">            Circumferential position of the dimple.</span>
<span class="sd">        pt : float</span>
<span class="sd">            Normalized meridional position.</span>
<span class="sd">        d : float</span>
<span class="sd">            Diameter of the drilling machine.</span>
<span class="sd">        drill_offset_deg : float, optional</span>
<span class="sd">            Angular offset when the drilling is not normal to the shell</span>
<span class="sd">            surface. A positive offset means a positive rotation about the</span>
<span class="sd">            `\theta` axis, along the meridional plane.</span>
<span class="sd">        clearance_factor : float, optional</span>
<span class="sd">            Fraction of the diameter to apply as clearance around the cutout.</span>
<span class="sd">            This clearance is partitoned and meshed separately from the rest of</span>
<span class="sd">            the cone / cylinder.</span>
<span class="sd">        numel_radial_edge : int, optional</span>
<span class="sd">            Number of elements along the radial edges about the cutout center.</span>
<span class="sd">            This parameter affects the aspect ratio of the elements inside the</span>
<span class="sd">            cutout area.</span>
<span class="sd">        prop_around_cutout : dict, optional</span>
<span class="sd">            Dictionary with keys:</span>

<span class="sd">            - &#39;mode&#39; : str (&#39;radius&#39; or &#39;partition&#39;)</span>
<span class="sd">            - &#39;radius&#39; : float</span>
<span class="sd">            - &#39;stack&#39;: list of floats</span>
<span class="sd">            - &#39;plyts&#39;: list of floats</span>
<span class="sd">            - &#39;mat_names&#39;: list of strings</span>
<span class="sd">            .</span>

<span class="sd">            Examples:</span>

<span class="sd">            - Defining a property with ``&#39;mode&#39;=&#39;radius&#39;``::</span>

<span class="sd">                prop_around_cutout = {</span>
<span class="sd">                    &#39;mode&#39;: &#39;radius&#39;,</span>
<span class="sd">                    &#39;radius&#39;: 10.,</span>
<span class="sd">                    &#39;stack&#39;: [0, 90, 0],</span>
<span class="sd">                    &#39;plyts&#39;: [0.125, 0.125, 0.125],</span>
<span class="sd">                    &#39;mat_names&#39;: [&#39;Alum&#39;, &#39;Alum&#39;, &#39;Alum&#39;],</span>
<span class="sd">                }</span>

<span class="sd">            - Defining a property with ``&#39;mode&#39;=&#39;partition&#39;``::</span>

<span class="sd">                prop_around_cutout = {</span>
<span class="sd">                    &#39;mode&#39;: &#39;partition&#39;,</span>
<span class="sd">                    &#39;stack&#39;: [0, 90, 0],</span>
<span class="sd">                    &#39;plyts&#39;: [0.125, 0.125, 0.125],</span>
<span class="sd">                    &#39;mat_names&#39;: [&#39;Alum&#39;, &#39;Alum&#39;, &#39;Alum&#39;],</span>
<span class="sd">                }</span>

<span class="sd">            .. note:: ``mat_names`` must be a list of materials already created in</span>
<span class="sd">                      the current model in Abaqus</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        cutout : :class:`.Cutout` object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cutout</span> <span class="o">=</span> <span class="n">Cutout</span><span class="p">(</span><span class="n">thetadeg</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">drill_offset_deg</span><span class="p">,</span> <span class="n">clearance_factor</span><span class="p">,</span>
                <span class="n">numel_radial_edge</span><span class="p">,</span> <span class="n">prop_around_cutout</span><span class="p">)</span>
        <span class="n">cutout</span><span class="o">.</span><span class="n">impconf</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cutouts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cutout</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cutout</span></div>


<div class="viewcode-block" id="ImpConf.add_ppi"><a class="viewcode-back" href="../../../../modules/abaqus/index.html#desicos.abaqus.imperfections.impconf.ImpConf.add_ppi">[docs]</a>    <span class="k">def</span> <span class="nf">add_ppi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">extra_height</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds Ply Piece Imperfection (PPI)</span>

<span class="sd">        There can be only one of these, so calling this function overrides the</span>
<span class="sd">        previous imperfection, if any.</span>
<span class="sd">        Note: Applicable for cones only!</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        info : list</span>
<span class="sd">            List of dictionaries with info about the layup of this cone.</span>
<span class="sd">            See :class:`.PPI` for more details</span>
<span class="sd">        extra_height : float</span>
<span class="sd">            Extra height above and below the cone height (`cc.H`) to consider</span>
<span class="sd">            in the ply placement model.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ppi : :class:`.PPI` object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;PPI object already set, overriding...&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ppi</span> <span class="o">=</span> <span class="n">PPI</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">extra_height</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ppi</span><span class="o">.</span><span class="n">impconf</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppi</span></div>


<div class="viewcode-block" id="ImpConf.add_ffi"><a class="viewcode-back" href="../../../../modules/abaqus/index.html#desicos.abaqus.imperfections.impconf.ImpConf.add_ffi">[docs]</a>    <span class="k">def</span> <span class="nf">add_ffi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nominal_vf</span><span class="p">,</span> <span class="n">E_matrix</span><span class="p">,</span> <span class="n">nu_matrix</span><span class="p">,</span> <span class="n">use_ti</span><span class="p">,</span> <span class="n">global_sf</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds Fiber Fraction Imperfection (FFI)</span>

<span class="sd">        There can be only one of these, so calling this function overrides the</span>
<span class="sd">        previous imperfection, if any.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nominal_vf : float</span>
<span class="sd">            Nominal fiber volume fraction of the material</span>
<span class="sd">        E_matrix : float</span>
<span class="sd">            Young&#39;s modulus of the matrix material</span>
<span class="sd">        nu_matrix : float</span>
<span class="sd">            Poisson&#39;s ratio of the matrix material</span>
<span class="sd">        use_ti : bool</span>
<span class="sd">            If ``True``, create varying material properties according to the</span>
<span class="sd">            thickness imperfection data (if present).</span>
<span class="sd">        global_sf : float or ``None``</span>
<span class="sd">            Global scaling factor to apply to the material thickness.</span>
<span class="sd">            Set to ``None`` to disable. The global scaling may be overridden</span>
<span class="sd">            by a thickness imperfection, if ``use_ti`` (see above) is ``True``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ffi : :class:`.FFI` object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ffi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;FFI object already set, overriding...&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ffi</span> <span class="o">=</span> <span class="n">FFI</span><span class="p">(</span><span class="n">nominal_vf</span><span class="p">,</span> <span class="n">E_matrix</span><span class="p">,</span> <span class="n">nu_matrix</span><span class="p">,</span> <span class="n">use_ti</span><span class="p">,</span> <span class="n">global_sf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ffi</span><span class="o">.</span><span class="n">impconf</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ffi</span></div>


    <span class="k">def</span> <span class="nf">rebuild</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># TODO: Reduce the amount of code duplication?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imperfections</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="c1"># uneven bottom edge</span>
        <span class="n">ube</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uneven_bottom_edge</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">ube</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">ube</span><span class="o">.</span><span class="n">rebuild</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imperfections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ube</span><span class="p">)</span>
        <span class="c1"># uneven top edge</span>
        <span class="n">ute</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uneven_top_edge</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">ute</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">ute</span><span class="o">.</span><span class="n">rebuild</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imperfections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ute</span><span class="p">)</span>
        <span class="c1"># ploads</span>
        <span class="k">for</span> <span class="n">pload</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ploads</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">pload</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">i</span>
            <span class="n">pload</span><span class="o">.</span><span class="n">rebuild</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">imperfections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pload</span><span class="p">)</span>
        <span class="c1"># CSBI</span>
        <span class="k">for</span> <span class="n">cb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cb</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">i</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">rebuild</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">imperfections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cb</span><span class="p">)</span>
        <span class="c1"># dimples</span>
        <span class="k">for</span> <span class="n">sb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimples</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">sb</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">i</span>
            <span class="n">sb</span><span class="o">.</span><span class="n">rebuild</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">imperfections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span>
        <span class="c1"># axisymmetrics</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axisymmetrics</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">i</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">rebuild</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">imperfections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="c1"># linear buckling mode-shaped imperfection (LBMI)</span>
        <span class="k">for</span> <span class="n">lbmi</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lbmis</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">lbmi</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">i</span>
            <span class="n">lbmi</span><span class="o">.</span><span class="n">rebuild</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">imperfections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lbmi</span><span class="p">)</span>
        <span class="c1"># cutout</span>
        <span class="k">for</span> <span class="n">cutout</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutouts</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">cutout</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">i</span>
            <span class="n">cutout</span><span class="o">.</span><span class="n">rebuild</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">imperfections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cutout</span><span class="p">)</span>
        <span class="c1"># ply piece imperfection</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ppi</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">i</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ppi</span><span class="o">.</span><span class="n">rebuild</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">imperfections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ppi</span><span class="p">)</span>
        <span class="c1"># fiber fraction imperfection</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ffi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ffi</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">i</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ffi</span><span class="o">.</span><span class="n">rebuild</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">imperfections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ffi</span><span class="p">)</span>
        <span class="c1"># thickness imperfection (TI)</span>
        <span class="k">for</span> <span class="n">ti</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tis</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">ti</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">i</span>
            <span class="n">ti</span><span class="o">.</span><span class="n">rebuild</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">imperfections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>
        <span class="c1"># mid-surface imperfection (MSI)</span>
        <span class="k">for</span> <span class="n">msi</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">msis</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">msi</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">i</span>
            <span class="n">msi</span><span class="o">.</span><span class="n">rebuild</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">imperfections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msi</span><span class="p">)</span>
        <span class="c1"># name</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rename</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;PLs_</span><span class="si">%02d</span><span class="s1">_dimples_</span><span class="si">%02d</span><span class="s1">_axisym_</span><span class="si">%02d</span><span class="s1">&#39;</span> <span class="o">+</span>\
                        <span class="s1">&#39;_lbmis_</span><span class="si">%02d</span><span class="s1">_MSIs_</span><span class="si">%02d</span><span class="s1">_TIs_</span><span class="si">%02d</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">%</span> \
                        <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ploads</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimples</span><span class="p">),</span>
                          <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axisymmetrics</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lbmis</span><span class="p">),</span>
                          <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">msis</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tis</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">imp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">imperfections</span><span class="p">:</span>
            <span class="n">valid</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">imp</span><span class="o">.</span><span class="n">pts</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">pt</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pt</span> <span class="o">&gt;</span> <span class="mf">1.</span><span class="p">:</span>
                    <span class="n">valid</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">imp</span> <span class="ow">and</span> <span class="n">valid</span><span class="p">:</span>
                <span class="n">imp</span><span class="o">.</span><span class="n">create</span><span class="p">()</span></div>

</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../../../index.html">
    <img class="logo" src="../../../../_static/desicos.png" alt="Logo"/>
    
  </a>
</p>










<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../modules/index.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/index.html">Tutorials</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2012-2020 Desicos Improved Software Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>