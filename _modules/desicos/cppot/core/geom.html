
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>desicos.cppot.core.geom &#8212; DESICOS 2.4.10 documentation</title>
    <link rel="stylesheet" href="../../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css" />
    <script id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for desicos.cppot.core.geom</h1><div class="highlight"><pre>
<span></span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">===============================================</span>
<span class="sd">CPPOT-geometry (:mod:`desicos.cppot.core.geom`)</span>
<span class="sd">===============================================</span>

<span class="sd">.. currentmodule:: desicos.cppot.core.geom</span>

<span class="sd">Classes and functions to help with 2D geometrical operations.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Save some lookup time for these often-used values</span>
<span class="n">pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">pi2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>

<div class="viewcode-block" id="wrap_to_pi"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.wrap_to_pi">[docs]</a><span class="k">def</span> <span class="nf">wrap_to_pi</span><span class="p">(</span><span class="n">angle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Wrap an angle to within the range [-pi, pi), by adding multiples of 2*pi</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angle : float</span>
<span class="sd">        The angle to wrap</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    new_angle : float</span>
<span class="sd">        Wrapped angle within the range [-pi, pi)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">angle</span> <span class="o">+</span> <span class="n">pi</span><span class="p">)</span> <span class="o">%</span> <span class="n">pi2</span> <span class="o">-</span> <span class="n">pi</span></div>


<div class="viewcode-block" id="angle_in_range"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.angle_in_range">[docs]</a><span class="k">def</span> <span class="nf">angle_in_range</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">angle_min</span><span class="p">,</span> <span class="n">angle_max</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check if an angle is within the specified range (min..max)</span>
<span class="sd">    While taking care of all the (mod 2pi)-issues.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angle : float</span>
<span class="sd">        The angle to check</span>
<span class="sd">    min_angle : float</span>
<span class="sd">        The lower limit of the range</span>
<span class="sd">    max_angle : float</span>
<span class="sd">        The upper limit of the range</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    in_range : bool</span>
<span class="sd">        True iff the given angle is in range min_angle...max_angle</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(((</span><span class="n">angle</span> <span class="o">-</span> <span class="n">angle_min</span><span class="p">)</span> <span class="o">%</span> <span class="n">pi2</span><span class="p">)</span> <span class="o">+</span>
            <span class="p">((</span><span class="n">angle_max</span> <span class="o">-</span> <span class="n">angle</span><span class="p">)</span> <span class="o">%</span> <span class="n">pi2</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">pi2</span></div>


<div class="viewcode-block" id="circle_segment_area"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.circle_segment_area">[docs]</a><span class="k">def</span> <span class="nf">circle_segment_area</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the area of a circle segment, which is a region bound by</span>
<span class="sd">    an arc (less than 180 deg) and a straight line connecting the end points</span>
<span class="sd">    of that arc.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    radius : float</span>
<span class="sd">        Radius of the arc</span>
<span class="sd">    angle : float</span>
<span class="sd">        Angle (in radians) of the arc</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    area : float</span>
<span class="sd">        The calculated area</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    See http://en.wikipedia.org/wiki/Circular_segment</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">radius</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">angle</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span></div>


<div class="viewcode-block" id="Point2D"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.Point2D">[docs]</a><span class="k">class</span> <span class="nc">Point2D</span><span class="p">(</span><span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Point2D&#39;</span><span class="p">,</span> <span class="s1">&#39;x y&#39;</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;Class representing a point on a two-dimensional plane</span>
<span class="sd">    It is based on ``namedtuple``, which allows both named attribute access</span>
<span class="sd">    (point.x) and iteration / indexing. Point2D instances are immutable after</span>
<span class="sd">    construction. Addition / subtraction operators are overloaded, as wel as</span>
<span class="sd">    pre-multiplying by a scalar.</span>

<span class="sd">    =========  ==========================================================</span>
<span class="sd">    Attribute  Description</span>
<span class="sd">    =========  ==========================================================</span>
<span class="sd">    ``x``      ``float``, Cartesian x-coordinate</span>
<span class="sd">    ``y``      ``float``, Cartesian y-coordinate</span>
<span class="sd">    =========  ==========================================================</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span> <span class="c1"># As recommended by python docs, saves memory</span>

    <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="c1"># Unpickling is done during creation</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="Point2D.angle"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.Point2D.angle">[docs]</a>    <span class="k">def</span> <span class="nf">angle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Calculate the angle of this point in polar coordinates</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        angle : float</span>
<span class="sd">            The counterclockwise angle (in radians) from the positive x-axis</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span></div>

<div class="viewcode-block" id="Point2D.norm"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.Point2D.norm">[docs]</a>    <span class="k">def</span> <span class="nf">norm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate distance of this point with respect to the origin.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span></div>

<div class="viewcode-block" id="Point2D.distance"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.Point2D.distance">[docs]</a>    <span class="k">def</span> <span class="nf">distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate Euclidean distance between two points.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Point2D</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span> <span class="o">-</span> <span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span></div>

<div class="viewcode-block" id="Point2D.rotate"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.Point2D.rotate">[docs]</a>    <span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Created a new point, rotated with respect to the origin.</span>
<span class="sd">        The original point remains untouched.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angle : float</span>
<span class="sd">            Angle (in radians) with which the point is to be rotated</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        new_point : :class:`Point2D`</span>
<span class="sd">            The newly constructed rotated point</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_polar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">norm</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">()</span> <span class="o">+</span> <span class="n">angle</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Addition operator, creates a new point at (x1+x2, y1+y2)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Point2D</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Subtraction operator, creates a new point at (x1-x2, y1-y2)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Point2D</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Pre-multiplication by a scalar</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">other</span><span class="p">)</span>

<div class="viewcode-block" id="Point2D.from_polar"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.Point2D.from_polar">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_polar</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Class method, creates a point from polar coordinates</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        norm : float</span>
<span class="sd">            Distance from the origin</span>
<span class="sd">        angle : float</span>
<span class="sd">            The counterclockwise angle (in radians) from the positive x-axis</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        point : :class:`Point2D`</span>
<span class="sd">            The newly constructed point</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">norm</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">norm</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="Line2D"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.Line2D">[docs]</a><span class="k">class</span> <span class="nc">Line2D</span><span class="p">(</span><span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Line2D&#39;</span><span class="p">,</span> <span class="s1">&#39;a b c&#39;</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;Class representing a line on a two-dimensional plane</span>
<span class="sd">    It is based on ``namedtuple``, which allows both named attribute access</span>
<span class="sd">    (line.a) and iteration / indexing. Line2D instances are immutable after</span>
<span class="sd">    construction.</span>

<span class="sd">    The line is defined based on two equations:</span>
<span class="sd">    a*x + b*y = c</span>
<span class="sd">    a**2 + b**2 = 1</span>
<span class="sd">    The latter normalization constraint is enforced in ``__new__``</span>

<span class="sd">    =========  ==========================================================</span>
<span class="sd">    Attribute  Description</span>
<span class="sd">    =========  ==========================================================</span>
<span class="sd">    ``a``      ``float``, Line parameter in equation (a*x + b*y = c)</span>
<span class="sd">    ``b``      ``float``, Line parameter in equation (a*x + b*y = c)</span>
<span class="sd">    ``c``      ``float``, Line parameter in equation (a*x + b*y = c)</span>
<span class="sd">    =========  ==========================================================</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span> <span class="c1"># As recommended by python docs, saves memory</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="c1"># Tuples are immutable after construction, so initialization</span>
        <span class="c1"># should be done in __new__ instead of __init__</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Line2D</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">a</span><span class="o">/</span><span class="n">norm</span><span class="p">,</span> <span class="n">b</span><span class="o">/</span><span class="n">norm</span><span class="p">,</span> <span class="n">c</span><span class="o">/</span><span class="n">norm</span><span class="p">)</span>

<div class="viewcode-block" id="Line2D.direction"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.Line2D.direction">[docs]</a>    <span class="k">def</span> <span class="nf">direction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain a point representing a unit direction vector parallel to the</span>
<span class="sd">        line.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        direction : :class:`Point2D`</span>
<span class="sd">            The requested unit direction vector</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Point2D</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span></div>

<div class="viewcode-block" id="Line2D.angle"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.Line2D.angle">[docs]</a>    <span class="k">def</span> <span class="nf">angle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Calculate the angle of this line with respect to the x-axis</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        angle : float</span>
<span class="sd">            The counterclockwise angle (in radians) from the positive x-axis</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span><span class="p">()</span><span class="o">.</span><span class="n">angle</span><span class="p">()</span></div>

<div class="viewcode-block" id="Line2D.rotate"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.Line2D.rotate">[docs]</a>    <span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Created a new line, rotated with respect to the origin.</span>
<span class="sd">        The original line remains untouched.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angle : float</span>
<span class="sd">            Angle (in radians) with which the line is to be rotated</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        new_line : :class:`Line2D`</span>
<span class="sd">            The newly constructed rotated line</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">a_new</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
        <span class="n">b_new</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">a_new</span><span class="p">,</span> <span class="n">b_new</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span></div>

<div class="viewcode-block" id="Line2D.distance_point"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.Line2D.distance_point">[docs]</a>    <span class="k">def</span> <span class="nf">distance_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the shortest Euclidean distance between this line and a point</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        point : :class:`Point2D`</span>
<span class="sd">            Point to find the distance to</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        distance : float</span>
<span class="sd">            The shortest distance from this line to the given point.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">Point2D</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="n">point</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">*</span><span class="n">point</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">)</span></div>

<div class="viewcode-block" id="Line2D.point_on_right"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.Line2D.point_on_right">[docs]</a>    <span class="k">def</span> <span class="nf">point_on_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check on which side of this line a point lies</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        point : :class:`Point2D`</span>
<span class="sd">            Point to check</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        on_right_side : bool</span>
<span class="sd">            ``True`` if the point is on the right side of this line (looking</span>
<span class="sd">            into the direction of ``self.direction()``), ``False`` otherwise.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="n">point</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">*</span><span class="n">point</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="Line2D.intersection_line"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.Line2D.intersection_line">[docs]</a>    <span class="k">def</span> <span class="nf">intersection_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the intersection point of this line and another line</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : :class:`Line2D`</span>
<span class="sd">            Other line to find intersection point with</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        intersection_point : :class:`Point2D`</span>
<span class="sd">            The found intersection point</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        If no intersection point could be found, a ValueError is raised.</span>
<span class="sd">        This can happen when the lines are parallel.</span>

<span class="sd">        See also:</span>
<span class="sd">        http://en.wikipedia.org/wiki/Intersection_(Euclidean_geometry)#Two_lines</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Line2D</span><span class="p">)</span>
        <span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">c1</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">a2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">other</span>
        <span class="n">denominator</span> <span class="o">=</span> <span class="n">a1</span><span class="o">*</span><span class="n">b2</span> <span class="o">-</span> <span class="n">a2</span><span class="o">*</span><span class="n">b1</span>
        <span class="k">if</span> <span class="n">denominator</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unable to find intersection of lines: Lines are identical or parallel&#39;</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="n">b2</span> <span class="o">-</span> <span class="n">c2</span><span class="o">*</span><span class="n">b1</span><span class="p">)</span> <span class="o">/</span> <span class="n">denominator</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">a1</span><span class="o">*</span><span class="n">c2</span> <span class="o">-</span> <span class="n">a2</span><span class="o">*</span><span class="n">c1</span><span class="p">)</span> <span class="o">/</span> <span class="n">denominator</span>
        <span class="k">return</span> <span class="n">Point2D</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></div>

<div class="viewcode-block" id="Line2D.all_intersections_circle"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.Line2D.all_intersections_circle">[docs]</a>    <span class="k">def</span> <span class="nf">all_intersections_circle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get all intersection points of a line with a circle</span>
<span class="sd">        The center of the circle is presumed to be at the origin</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        radius : float</span>
<span class="sd">            Radius of circle</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        intersection_points : list of :class:`Point2D`</span>
<span class="sd">            List containing either 0, 1 or 2 intersection points</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        See also:</span>
<span class="sd">        http://en.wikipedia.org/wiki/Intersection_(Euclidean_geometry)#A_line_and_a_circle</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="c1"># The fact that a**2 + b**2 = 1 simplifies things a bit</span>
        <span class="n">D</span> <span class="o">=</span> <span class="n">radius</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">c</span><span class="o">**</span><span class="mi">2</span>

        <span class="c1"># Line does not cut circle</span>
        <span class="k">if</span> <span class="n">D</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="c1"># Line cuts circle at exactly one point</span>
        <span class="k">elif</span> <span class="n">D</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">c</span>
            <span class="n">y1</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">c</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">Point2D</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)]</span>

        <span class="c1"># Line cuts circle at two points</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># D &gt; 0</span>
            <span class="n">sqrtD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">c</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">sqrtD</span>
            <span class="n">y1</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">c</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="n">sqrtD</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">c</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">sqrtD</span>
            <span class="n">y2</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">c</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">sqrtD</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">Point2D</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">Point2D</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)]</span></div>

<div class="viewcode-block" id="Line2D.intersection_circle_near"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.Line2D.intersection_circle_near">[docs]</a>    <span class="k">def</span> <span class="nf">intersection_circle_near</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">near_point</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the intersection of a line with a circle</span>
<span class="sd">        If there is more than one intersection point, it returns the</span>
<span class="sd">        intersection closest to near_point. If there is no intersection,</span>
<span class="sd">        a ValueError is raised.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        radius : float</span>
<span class="sd">            Radius of circle</span>
<span class="sd">        nearby_point : :class:`Point2D`</span>
<span class="sd">            The intersection nearest to this point will be returned</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        intersection_point : :class:`Point2D`</span>
<span class="sd">            The found intersection point</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">near_point</span><span class="p">,</span> <span class="n">Point2D</span><span class="p">)</span>
        <span class="n">ips</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_intersections_circle</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ips</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Error finding intersection of line and circle: there is none&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">ips</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ips</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">ips</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">ip1</span><span class="p">,</span> <span class="n">ip2</span> <span class="o">=</span> <span class="n">ips</span>
            <span class="n">d1</span> <span class="o">=</span> <span class="p">(</span><span class="n">near_point</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">ip1</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">near_point</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">ip1</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">d2</span> <span class="o">=</span> <span class="p">(</span><span class="n">near_point</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">ip2</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">near_point</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">ip2</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
            <span class="k">return</span> <span class="n">ip1</span> <span class="k">if</span> <span class="n">d1</span> <span class="o">&lt;</span> <span class="n">d2</span> <span class="k">else</span> <span class="n">ip2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="kc">False</span> <span class="c1"># Should not be reached</span></div>

<div class="viewcode-block" id="Line2D.from_point_angle"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.Line2D.from_point_angle">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_point_angle</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Class method, constructs a line based on a point and an angle</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        point : :class:`Point2D`</span>
<span class="sd">            Point that the line should go through</span>
<span class="sd">        angle : float</span>
<span class="sd">            The counterclockwise angle (in radians) between the line and the positive x-axis</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        line : :class:`Line2D`</span>
<span class="sd">            The constructed line</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">Point2D</span><span class="p">)</span>
        <span class="nb">dir</span> <span class="o">=</span> <span class="n">Point2D</span><span class="o">.</span><span class="n">from_polar</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="nb">dir</span><span class="o">.</span><span class="n">y</span>
        <span class="n">b</span> <span class="o">=</span> <span class="nb">dir</span><span class="o">.</span><span class="n">x</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">point</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">point</span><span class="o">.</span><span class="n">y</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span></div>

<div class="viewcode-block" id="Line2D.from_points"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.Line2D.from_points">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_points</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">point1</span><span class="p">,</span> <span class="n">point2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Class method, constructs a line based on two points</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        point1 : :class:`Point2D`</span>
<span class="sd">            First point that the line should go through</span>
<span class="sd">        point2 : :class:`Point2D`</span>
<span class="sd">            Second point that the line should go through</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        line : :class:`Line2D`</span>
<span class="sd">            The constructed line</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        If no line can be constructed, a ValueError is raised.</span>
<span class="sd">        This happens when the points are identical.</span>

<span class="sd">        See also:</span>
<span class="sd">        http://math.stackexchange.com/questions/422602/convert-two-points-to-line-eq-ax-by-c-0</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">point1</span><span class="p">,</span> <span class="n">Point2D</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">point2</span><span class="p">,</span> <span class="n">Point2D</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">point1</span> <span class="o">==</span> <span class="n">point2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unable to construct line between points: they are identical&#39;</span><span class="p">)</span>
        <span class="nb">dir</span> <span class="o">=</span> <span class="n">point2</span> <span class="o">-</span> <span class="n">point1</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_point_angle</span><span class="p">(</span><span class="n">point1</span><span class="p">,</span> <span class="nb">dir</span><span class="o">.</span><span class="n">angle</span><span class="p">())</span></div></div>


<div class="viewcode-block" id="Polygon2D"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.Polygon2D">[docs]</a><span class="k">class</span> <span class="nc">Polygon2D</span><span class="p">(</span><span class="nb">tuple</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class representing a polygon on a two-dimensional plane.</span>
<span class="sd">    It is assumed that polygons do not self-intersect</span>

<span class="sd">    Pass an iterable of ``Point2D``-objects to the constructor.</span>
<span class="sd">    Polygon2D instances are immutable after construction.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Even though this object if (currently) a tuple of its points, it is</span>
<span class="sd">    recommended to not rely on this. This to allow possible future changes to</span>
<span class="sd">    the underlying implementation.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span> <span class="c1"># As recommended by python docs, saves memory</span>

<div class="viewcode-block" id="Polygon2D.points"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.Polygon2D.points">[docs]</a>    <span class="k">def</span> <span class="nf">points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get an iterator over all corner points in this polygon&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Polygon2D.area"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.Polygon2D.area">[docs]</a>    <span class="k">def</span> <span class="nf">area</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the area enclosed by this polygon.</span>

<span class="sd">        See also:</span>
<span class="sd">        http://en.wikipedia.org/wiki/Shoelace_formula</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">0.5</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="o">*</span><span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="o">*</span><span class="n">p</span><span class="o">.</span><span class="n">y</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span></div>

<div class="viewcode-block" id="Polygon2D.contains_point"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.Polygon2D.contains_point">[docs]</a>    <span class="k">def</span> <span class="nf">contains_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Determine if a point is inside or outside the polygon</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        point : :class:`Point2D`</span>
<span class="sd">            Point to test</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        inside_polygon : bool</span>
<span class="sd">            ``True`` if the point is inside the polygon, ``False`` otherwise</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The &#39;Ray casting&#39; algorithm is used, since the &#39;interior angle&#39;</span>
<span class="sd">        algorithm was found to be very slow.</span>

<span class="sd">        This method has not been verified to work correctly for special cases,</span>
<span class="sd">        such as the point being (almost) exactly on a vertex or line.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">crossings</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># We use a coordinate system with &#39;point&#39; at the origin, so shift polygon</span>
        <span class="n">shifted_polygon</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="o">-</span> <span class="n">point</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]</span>
        <span class="c1"># Iterate over all connected pairs of points</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">shifted_polygon</span><span class="p">)):</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">shifted_polygon</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">shifted_polygon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="c1"># The ray that we use is along the positive x-axis. Now check if the</span>
            <span class="c1"># line from (x1, y1) to (x2, y2) intersects the positive x-axis</span>

            <span class="c1"># First, check if the points are on different sides of the x-axis</span>
            <span class="c1"># Else, there is no intersection at all</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">y1</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">y2</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">y1</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">y2</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">):</span>
                <span class="c1"># Second, check that they intersect the x-axis at x &gt;= 0</span>
                <span class="k">if</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">y1</span><span class="o">*</span><span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y2</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">crossings</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1"># Odd number of crossings -&gt; point is inside</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">crossings</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="Polygon2D.get_closed_line"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.Polygon2D.get_closed_line">[docs]</a>    <span class="k">def</span> <span class="nf">get_closed_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_points</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a closed line that can be used to plot this polygon.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        num_points : int</span>
<span class="sd">            The number of points to use per edge. Default value is 1.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        out : tuple</span>
<span class="sd">            out[0] contains a numpy array of x-coordinates, out[1] an array</span>
<span class="sd">            of y-coordinates. The first point in the polygon is repeated, such</span>
<span class="sd">            that plot(x, y) results in a closed polygon.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">num_points</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">num_points</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)))</span>
            <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">num_points</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">num_points</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">y</span><span class="p">)</span></div>

<div class="viewcode-block" id="Polygon2D.slice_line"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.Polygon2D.slice_line">[docs]</a>    <span class="k">def</span> <span class="nf">slice_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Slice this polygon, returning only the section on the right side</span>
<span class="sd">        of the given line.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        line : :class:`Line2D`</span>
<span class="sd">            Line to be used for slicing.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        new_poly : :class:`Polygon2D`</span>
<span class="sd">            The (newly created) sliced polygon.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">point_on_right</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">!=</span> <span class="n">line</span><span class="o">.</span><span class="n">point_on_right</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">edge</span> <span class="o">=</span> <span class="n">Line2D</span><span class="o">.</span><span class="n">from_points</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">intersection_line</span><span class="p">(</span><span class="n">edge</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">point_on_right</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></div>

<div class="viewcode-block" id="Polygon2D.rotate"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.Polygon2D.rotate">[docs]</a>    <span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rotate_angle</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new polygon, idential to this one but rotated around the</span>
<span class="sd">        origin by a certain angle.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        rotate_angle : float</span>
<span class="sd">            Rotation angle to use, in radians</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        new_poly : :class:`Polygon2D`</span>
<span class="sd">            The (newly created) rotated polygon.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rotate_angle</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rotate_angle</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">Point2D</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">s</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ConeGeometry"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.ConeGeometry">[docs]</a><span class="k">class</span> <span class="nc">ConeGeometry</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;ConeGeometry object</span>

<span class="sd">    Carries all the information about the geometry of a cone, plus some</span>
<span class="sd">    read-only accessors to calculate often-needed cone properties. These are</span>
<span class="sd">    all calculated on-the-fly, so no rebuild()-ing is necessary.</span>

<span class="sd">    ================  ==================================================</span>
<span class="sd">    Attribute         Description</span>
<span class="sd">    ================  ==================================================</span>
<span class="sd">    ``H``             ``float``, height of the free area of the cone.</span>
<span class="sd">    ``rbot``          ``float``, bottom radius of the cone</span>
<span class="sd">    ``alpharad``      ``float``, semi-vertex angle of the cone, in</span>
<span class="sd">                      radians. Must be between 0 and pi/2.</span>
<span class="sd">    ``extra_height``  ``float``, extra (support) height. A section with</span>
<span class="sd">                      this height is added along both the top and bottom</span>
<span class="sd">                      edge of the free cone. This represents the extra</span>
<span class="sd">                      material that is present during manufacturing.</span>
<span class="sd">    ================  ==================================================</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">rbot</span><span class="p">,</span> <span class="n">alpharad</span><span class="p">,</span> <span class="n">extra_height</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">H</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rbot</span> <span class="o">=</span> <span class="n">rbot</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">alpharad</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Not a cone; required is 0 &lt; alpha &lt; 90 (degrees)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpharad</span> <span class="o">=</span> <span class="n">alpharad</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extra_height</span> <span class="o">=</span> <span class="n">extra_height</span>

<div class="viewcode-block" id="ConeGeometry.from_conecyl"><a class="viewcode-back" href="../../../../modules/cppot/index.html#desicos.cppot.core.geom.ConeGeometry.from_conecyl">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_conecyl</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">cc</span><span class="p">,</span> <span class="n">extra_height</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Construct a ConeGeometry object based on an existing ConeCyl</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cc : :class:`.ConeCyl`</span>
<span class="sd">            Existing cone to use. Must be a cone, i.e. alpha &gt; 0.</span>
<span class="sd">        extra_height : float</span>
<span class="sd">            Extra support height for this model.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        cg : :class:`.ConeGeometry`</span>
<span class="sd">            The constructed ConeGeometry object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">cc</span><span class="o">.</span><span class="n">H</span><span class="p">,</span> <span class="n">cc</span><span class="o">.</span><span class="n">rbot</span><span class="p">,</span> <span class="n">cc</span><span class="o">.</span><span class="n">alpharad</span><span class="p">,</span> <span class="n">extra_height</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sin_alpha</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read-only property: Sine of the semi-vertex angle.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpharad</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cos_alpha</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read-only property: Cosine of the semi-vertex angle.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpharad</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">tan_alpha</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read-only property: Tangent of the semi-vertex angle.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpharad</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rtop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read-only property: Top radius of the cone.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rbot</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">tan_alpha</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">L</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read-only property: Meridional length.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">cos_alpha</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">s1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read-only property: Radius of top (support) edge in unfolded coordinates.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rbot</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sin_alpha</span> <span class="o">-</span> \
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">extra_height</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">cos_alpha</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">s2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read-only property: Radius of top edge of the free cone in unfolded coordinates.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rbot</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sin_alpha</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">cos_alpha</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">s3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read-only property: Radius of bottom edge of the free cone in unfolded coordinates.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rbot</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sin_alpha</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">s4</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read-only property: Radius of bottom (support) edge in unfolded coordinates.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rbot</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sin_alpha</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">extra_height</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">cos_alpha</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cone_area</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read-only property: Surface area of the free cone (supports excluded).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sin_alpha</span></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../../../index.html">
    <img class="logo" src="../../../../_static/desicos.png" alt="Logo"/>
    
  </a>
</p>










<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../modules/index.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/index.html">Tutorials</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2012-2020 Desicos Improved Software Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>